<div id="sampleDemo" class="demo-padding demo-container">
  <div id="componentDemoContent" style="width: 1px; min-width: 100%;">

    <div id="tableWrapper">
      <div id="componentDemoContent" style="width: 1px; min-width: 100%;">                
        <div id="sampleDemo" class="demo-padding demo-container">
          <div id="componentDemoContent" style="width: 1px; min-width: 100%;">
                    
            <div id="parentContainer" class="oj-sm-padding-2x">
              <oj-button on-oj-action='[[selectFiles]]'>
                <span slot='startIcon' class='oj-ux-ico-plus'></span>
                Add Files    
              </oj-button>
              <oj-button on-oj-action='[[expandAll]]'>
                <span slot='startIcon' class='oj-ux-ico-expand'></span>
                Expand All  
              </oj-button>
              <oj-button on-oj-action='[[collapseAll]]'>
                <span slot='startIcon' class='oj-ux-ico-collapse'></span>
                Collapse All  
              </oj-button>
              <oj-button on-oj-action='[[exportFile]]'>
                <span slot='startIcon' class='oj-ux-ico-minus'></span>
                Export table to excel   
              </oj-button>
              <div class="oj-sm-padding-1x-top">Selected file :
                <oj-bind-text value="[[fileNames]]"></oj-bind-text>
              </div>
            </div>

           
       
      </div>
      </div>


      <oj-table id="table" aria-label="Departments Table" class='oj-bg-body demo-table-container'
        data='[[dataprovider]]'
        edit-mode="rowEdit"
        row-renderer="[[rowRenderer]]"
        on-oj-before-row-edit-end="[[beforeRowEditEndListener]]"

        layout="fixed" columns='[{"field": "name",
                                "weight": "3",
                                "minWidth": "10rem",
                                "headerText": "Name",
                                "template": "deptNameTemplate"},
                                {"field": "Price",
                                "weight": "3",
                                "minWidth": "5rem",
                                "headerText": "Price",
                                "template": "PriceTemplate"},
                                {"field": "Tax",
                                "weight": "3",
                                "minWidth": "5rem",
                                "headerText": "Tax",
                                "template": "TaxTemplate"},
                                {"field": "TotalPrice",
                                "weight": "3",
                                "minWidth": "5rem",
                                "headerText": "Total Price",
                                "className": "oj-helper-text-align-center oj-read-only",
                                "template": "totalPriceTemplate"},
                                {"field": "TotalSum",
                                "weight": "3",
                                "minWidth": "5rem",
                                "headerText": "Total Sum",
                                "className": "oj-helper-text-align-center oj-read-only",
                                "template": "totalSumTemplate"},
                                {"field": "CustomParent",
                                "headerText": "Parent Id",
                                "width": "6.2rem",
                                "headerStyle": "text-align: center;",
                                "style":"padding-top: 0px; padding-bottom: 0px; text-align: center;",
                                "template": "actionTemplate"},
                                {"field": "bomLevel",
                                "headerText": "Bom Level",
                                "width": "6.2rem",
                                "headerStyle": "text-align: center;",
                                "style":"padding-top: 0px; padding-bottom: 0px; text-align: center;",
                                "template": "actionTemplate"}]'>
      </oj-table>
      

      <br>
          <br>
          To edit a row, double click on it or press Enter. Press Esc to return to readonly. F2 toggles between editable and readonly.
          <br>
          <br>
          <b>Edited Row Data</b>
          <br>
          <br>
          <textarea id="rowDataDump" style="height: 100px; width: 1000px; box-sizing: border-box;"></textarea>

      
      <script type="text/html" id="row_template">
        <tr>
          <td>
            <oj-row-expander context="[[$context.rowContext]]"></oj-row-expander>
              <span><oj-bind-text value="[[$context.data.name]]"></oj-bind-text></span>
          </td>
          <td>
            <span><oj-bind-text value="[[$context.data.Price]]"></oj-bind-text></span>
          </td>
          <td>
              <span><oj-bind-text value="[[$context.data.Tax]]"></oj-bind-text></span>
          </td>
          <td>
            <span><oj-bind-text value="[[$context.data.TotalPrice]]"></oj-bind-text></span>
          </td>
          <td>
            <span><oj-bind-text value="[[$context.data.TotalSum]]"></oj-bind-text></span>
          </td>
          <td>
            <span><oj-bind-text value="[[$context.data.CustomParent]]"></oj-bind-text></span>
          </td>
          <td>
            <span><oj-bind-text value="[[$context.data.bomLevel]]"></oj-bind-text></span>
          </td>
        </tr>
      </script>


      <script type="text/html" id="row_template_editable">
        <tr>
            <td>
                <oj-row-expander context="[[$context.rowContext]]"></oj-row-expander>
                <span data-bind="text: name"></span>
            </td>
            <td>
                <oj-input-number id="it2" value="{{Price}}"></oj-input-text>
            </td>
            <td>
                <oj-input-number id="it3" value="{{Tax}}"></oj-input-text>
            </td>
            <td>
              <oj-input-number id="it4" value="{{TotalPrice}}"></oj-input-text>
          </td>
          <td>
            <oj-input-text id="it4" value="{{TotalSum}}"></oj-input-text>
        </td>
        <td>
          <oj-input-number id="it4" value="{{CustomParent}}"></oj-input-text>
      </td>
      <td>
        <oj-input-number id="it4" value="{{bomLevel}}"></oj-input-text>
    </td>
        </tr>
    </script>


      <oj-table id="excel_data" aria-label="Departments Table" class='oj-bg-body demo-table-container'
      data='[[dp]]'
      row-renderer='[[KnockoutTemplateUtils.getRenderer("row_template", true)]]'
      layout="fixed" columns='[{"field": "name",
                              "weight": "3",
                              "minWidth": "10rem",
                              "headerText": "Name",
                              "template": "deptNameTemplate"},
                              {"field": "Price",
                              "weight": "3",
                              "minWidth": "5rem",
                              "headerText": "Price",
                              "template": "PriceTemplate"},
                              {"field": "Tax",
                              "weight": "3",
                              "minWidth": "5rem",
                              "headerText": "Tax",
                              "template": "TaxTemplate"},
                              {"field": "TotalPrice",
                              "weight": "3",
                              "minWidth": "5rem",
                              "headerText": "Total Price",
                              "className": "oj-helper-text-align-center oj-read-only",
                              "template": "totalPriceTemplate"},
                              {"field": "TotalSum",
                              "weight": "3",
                              "minWidth": "5rem",
                              "headerText": "Total Sum",
                              "className": "oj-helper-text-align-center oj-read-only",
                              "template": "totalSumTemplate"},
                              {"headerText": "Parent Id",
                              "width": "6.2rem",
                              "headerStyle": "text-align: center;",
                              "style":"padding-top: 0px; padding-bottom: 0px; text-align: center;",
                              "template": "actionTemplate"},
                              {"headerText": "Bom Level",
                              "width": "6.2rem",
                              "headerStyle": "text-align: center;",
                              "style":"padding-top: 0px; padding-bottom: 0px; text-align: center;",
                              "template": "actionTemplate"}]'>
      </oj-table>
    </div>
  </div>
</div>